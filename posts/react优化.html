<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>React ç®€å•ä¼˜åŒ– | klein</title>
    <meta name="description" content="React">
    <link rel="stylesheet" href="/klein/assets/style.9690f22c.css">
    <link rel="modulepreload" href="/klein/assets/app.4feed8ca.js">
    <link rel="modulepreload" href="/klein/assets/posts_reactä¼˜åŒ–.md.0fab6639.lean.js">
    
    <link rel="icon" href="/logo.jpg">
  <meta name="author" content="klein">
  <meta property="og:title" content="Home">
  <meta property="og:description" content="Home of klein">
  <script id="check-dark-light">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
  </head>
  <body>
    <div id="app"><!--[--><div class="Layout" data-v-82528fa6><!--[--><!--]--><!--[--><span tabindex="-1" data-v-f637ee78></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-f637ee78> Skip to content </a><!--]--><!----><header class="VPNav no-sidebar" data-v-82528fa6 data-v-86afb924><div class="VPNavBar" data-v-86afb924 data-v-7a5a363d><div class="container" data-v-7a5a363d><div class="VPNavBarTitle" data-v-7a5a363d data-v-aaed7263><a class="title" href="/klein/" data-v-aaed7263><!--[--><!--]--><!--[--><img class="VPImage logo" src="/klein/logo.jpg" alt data-v-ca1a0a93><!--]--><!--[-->klein<!--]--><!--[--><!--]--></a></div><div class="content" data-v-7a5a363d><!--[--><!--]--><!----><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-7a5a363d data-v-d8cdd395><span id="main-nav-aria-label" class="visually-hidden" data-v-d8cdd395>Main Navigation</span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/klein/" data-v-d8cdd395 data-v-08b6ef03 data-v-97a44ddd><!--[-->ğŸ¡Blogs<!--]--><!----></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/klein/tags.html" data-v-d8cdd395 data-v-08b6ef03 data-v-97a44ddd><!--[-->ğŸ”–Tags<!--]--><!----></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/klein/archives.html" data-v-d8cdd395 data-v-08b6ef03 data-v-97a44ddd><!--[-->ğŸ“ƒArchives<!--]--><!----></a><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-7a5a363d data-v-d70ebc80><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" aria-label="toggle dark mode" aria-checked="false" data-v-d70ebc80 data-v-9a8716a3 data-v-3258a739><span class="check" data-v-3258a739><span class="icon" data-v-3258a739><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-9a8716a3><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-9a8716a3><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-7a5a363d data-v-6a2a6555 data-v-b8f6762d><!--[--><a class="VPSocialLink" href="https://github.com/helloklein" target="_blank" rel="noopener" data-v-b8f6762d data-v-179ad0ea><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-7a5a363d data-v-b390db70 data-v-aeb1c475><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-aeb1c475><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="icon" data-v-aeb1c475><circle cx="12" cy="12" r="2"></circle><circle cx="19" cy="12" r="2"></circle><circle cx="5" cy="12" r="2"></circle></svg></button><div class="menu" data-v-aeb1c475><div class="VPMenu" data-v-aeb1c475 data-v-079aa243><!----><!--[--><!--[--><!----><div class="group" data-v-b390db70><div class="item appearance" data-v-b390db70><p class="label" data-v-b390db70>Appearance</p><div class="appearance-action" data-v-b390db70><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" aria-label="toggle dark mode" aria-checked="false" data-v-b390db70 data-v-9a8716a3 data-v-3258a739><span class="check" data-v-3258a739><span class="icon" data-v-3258a739><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-9a8716a3><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-9a8716a3><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div></div></div><div class="group" data-v-b390db70><div class="item social-links" data-v-b390db70><div class="VPSocialLinks social-links-list" data-v-b390db70 data-v-b8f6762d><!--[--><a class="VPSocialLink" href="https://github.com/helloklein" target="_blank" rel="noopener" data-v-b8f6762d data-v-179ad0ea><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-7a5a363d data-v-6bee1efd><span class="container" data-v-6bee1efd><span class="top" data-v-6bee1efd></span><span class="middle" data-v-6bee1efd></span><span class="bottom" data-v-6bee1efd></span></span></button></div></div></div><!----></header><!----><!----><div class="VPContent" id="VPContent" data-v-82528fa6 data-v-b2b5ab3c><div class="VPDoc" data-v-b2b5ab3c data-v-6b6fcb79><div class="container" data-v-6b6fcb79><!----><div class="content" data-v-6b6fcb79><div class="content-container" data-v-6b6fcb79><!--[--><!--[--><!--[--><!--[--><h1 class="title" data-v-701f5214>React ç®€å•ä¼˜åŒ–</h1><div class="date" data-v-701f5214>ğŸ•’ Published at: 2 years ago</div><!--]--><div class="category" data-v-97a92d7f><ul class="list" data-v-97a92d7f><!--[--><li class="header" data-v-97a92d7f><!----><ul data-v-97a92d7f><!--[--><!--]--></ul></li><li class="header" data-v-97a92d7f><!----><ul data-v-97a92d7f><!--[--><!--]--></ul></li><li class="header" data-v-97a92d7f><!----><ul data-v-97a92d7f><!--[--><!--]--></ul></li><li class="header" data-v-97a92d7f><!----><ul data-v-97a92d7f><!--[--><!--]--></ul></li><li class="header" data-v-97a92d7f><!----><ul data-v-97a92d7f><!--[--><!--]--></ul></li><!--]--></ul></div><!--]--><!--]--><!--]--><main class="main" data-v-6b6fcb79><div style="position:relative;" class="vp-doc _klein_posts_react%E4%BC%98%E5%8C%96" data-v-6b6fcb79><div><h3 id="ä¼˜åŒ–çš„åŸå› " tabindex="-1">ä¼˜åŒ–çš„åŸå›  <a class="header-anchor" href="#ä¼˜åŒ–çš„åŸå› " aria-hidden="true">#</a></h3><p>react é‡Œçš„ä¸€ä¸ªåŸºæœ¬å¸¸è¯†æ˜¯ re-renderï¼šå½“ä¸€ä¸ªç»„ä»¶é‡Œçš„æŸä¸ªçŠ¶æ€æ”¹å˜çš„æ—¶å€™ï¼Œä»–ä¼šé‡æ–°æ¸²æŸ“ï¼Œä¹Ÿå°±æ˜¯é‡æ–°æ‰§è¡Œæ‰€æœ‰ç»„ä»¶ä»£ç ï¼ŒåŒ…æ‹¬å®ƒçš„å­ç»„ä»¶ã€‚</p><p>æ‰€ä»¥ä¼šå¸¦æ¥å¾ˆå¤šä¸å¿…è¦çš„é‡æ–°æ¸²æŸ“ã€‚</p><h3 id="usememo" tabindex="-1">useMemo <a class="header-anchor" href="#usememo" aria-hidden="true">#</a></h3><p>useMemo çš„åŸºæœ¬ç†å¿µæ˜¯ï¼Œå®ƒå…è®¸æˆ‘ä»¬åœ¨æ¸²æŸ“ä¹‹é—´ &quot;è®°ä½ &quot;ä¸€ä¸ªè®¡ç®—å€¼</p><h4 id="ä½¿ç”¨çš„åœºæ™¯ä¸¾ä¾‹" tabindex="-1">ä½¿ç”¨çš„åœºæ™¯ä¸¾ä¾‹ <a class="header-anchor" href="#ä½¿ç”¨çš„åœºæ™¯ä¸¾ä¾‹" aria-hidden="true">#</a></h4><div class="language-tsx"><button title="Copy Code" class="copy"></button><span class="lang">tsx</span><pre class="shiki"><code><span class="line"><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">App</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">selectedNum</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">setSelectedNum</span><span style="color:#89DDFF;">]</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">React</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">useState</span><span style="color:#F07178;">(</span><span style="color:#F78C6C;">100</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">time</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">useTime</span><span style="color:#F07178;">()</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">allPrimes</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">React</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">useMemo</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">()</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">result</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> []</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">for</span><span style="color:#F07178;"> (</span><span style="color:#C792EA;">let</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">counter</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">2</span><span style="color:#89DDFF;">;</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">counter</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">selectedNum</span><span style="color:#89DDFF;">;</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">counter</span><span style="color:#89DDFF;">++</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">if</span><span style="color:#F07178;"> (</span><span style="color:#82AAFF;">isPrime</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">counter</span><span style="color:#F07178;">)) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#A6ACCD;">result</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">push</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">counter</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">return</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">result</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">},</span><span style="color:#F07178;"> [</span><span style="color:#A6ACCD;">selectedNum</span><span style="color:#F07178;">])</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">   </span><span style="color:#89DDFF;">return</span><span style="color:#F07178;"> (</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">&lt;-</span><span style="color:#A6ACCD;">çœç•¥dom</span><span style="color:#89DDFF;">-&gt;</span></span>
<span class="line"><span style="color:#F07178;">   )</span></span>
<span class="line"></span></code></pre></div><p>è¿™é‡Œ App ç»„ä»¶é‡Œæœ‰ä¸€ä¸ªçŠ¶æ€ selectedNum,è¿˜æœ‰ä¸€ä¸ªè‡ªå®šä¹‰ hook å¯¼å‡ºçš„çŠ¶æ€ timeã€‚å‡å¦‚ä¸ä½¿ç”¨ useMemo åŒ…è£¹ allPrimesï¼Œé‚£ä¹ˆæ¯å½“ time å˜åŒ–çš„æ—¶å€™ï¼Œå°±ä¼šé‡æ–°æ‰§è¡Œ allPrimses é‡Œé¢çš„ä»£ç ï¼Œé€ æˆæµªè´¹ï¼›ç„¶è€Œæˆ‘ä»¬çš„ allPrimes å…¶å®åªè·Ÿ selectedNum ç›¸å…³ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿™é‡Œç”¨ useMemo ç¼“å­˜å‡½æ•°åŒ…è£¹åï¼Œé‡Œé¢çš„ä»£ç å°±åªä¼šåœ¨ selectedNum å˜åŒ–æ—¶æ‰§è¡Œï¼Œè€Œä¸å— App ç»„ä»¶çš„ re-render å½±å“ã€‚</p><p>å½“ç„¶ï¼Œè¿™é‡Œä¹Ÿå¯ä»¥æœ‰å…¶ä»–çš„å†™æ³•ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠ allPrimes å’Œ selectedNum åŒ…æ‹¬å®ƒçš„ dom åˆå¹¶æˆä¸€ä¸ªå­ç»„ä»¶ï¼Œtime å’Œå®ƒçš„ dom ä¹Ÿåˆå¹¶æˆä¸€ä¸ªå­ç»„ä»¶</p><div class="language-tsx"><button title="Copy Code" class="copy"></button><span class="lang">tsx</span><pre class="shiki"><code><span class="line"><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">App</span><span style="color:#89DDFF;">(){</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">return</span><span style="color:#F07178;">(</span></span>
<span class="line"><span style="color:#F07178;">  	</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">Time</span><span style="color:#89DDFF;"> /&gt;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">AllPrimes</span><span style="color:#89DDFF;"> /&gt;</span></span>
<span class="line"><span style="color:#F07178;">  )</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><p>è¿™æ ·ï¼Œä»–ä»¬çš„çŠ¶æ€éš”ç¦»å¼€ï¼Œä¹Ÿå¯ä»¥å®ç°å½“ time é‡Œé¢çš„çŠ¶æ€æ”¹å˜çš„æ—¶å€™ï¼Œä¸ä¼šå½±å“åˆ«çš„ä»£ç å» re-renderã€‚</p><p>ä½†æ˜¯ï¼Œæœ‰æ—¶å€™ï¼Œæˆ‘ä»¬åè€Œæ˜¯éœ€è¦æŠŠçŠ¶æ€æ”¾åˆ°å¤–éƒ¨ç»„ä»¶çš„ï¼Œå› ä¸ºå¯èƒ½æœ‰åˆ«çš„ç»„ä»¶ä¹ŸåŒæ ·ä¾èµ–è¿™ä¸ªçŠ¶æ€ã€‚</p><div class="language-tsx"><button title="Copy Code" class="copy"></button><span class="lang">tsx</span><pre class="shiki"><code><span class="line"><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">App</span><span style="color:#89DDFF;">(){</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">time</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">useTime</span><span style="color:#F07178;">()</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">return</span><span style="color:#F07178;">(</span></span>
<span class="line"><span style="color:#F07178;">  	</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">Time</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">time</span><span style="color:#89DDFF;">={</span><span style="color:#A6ACCD;">time</span><span style="color:#89DDFF;">} /&gt;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">AllPrimes</span><span style="color:#89DDFF;"> /&gt;</span></span>
<span class="line"><span style="color:#F07178;">  )</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><p>è¿™æ ·çš„è¯ï¼Œå½“ App ç»„ä»¶çš„ time çŠ¶æ€å˜åŒ–çš„æ—¶å€™ï¼Œå…¶å®åŒæ ·ä¼šä½¿ Time ç»„ä»¶å’Œ AllPrimes ç»„ä»¶ re-renderã€‚è¿™ä¸ªæ—¶å€™ï¼Œå°±å¯ä»¥ä½¿ç”¨ React.memo æ¥ä¼˜åŒ–</p><div class="language-tsx"><button title="Copy Code" class="copy"></button><span class="lang">tsx</span><pre class="shiki"><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> PureAllPrimes </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> React</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">memo</span><span style="color:#A6ACCD;">(AllPrimes)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">App</span><span style="color:#89DDFF;">(){</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">time</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">useTime</span><span style="color:#F07178;">()</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">return</span><span style="color:#F07178;">(</span></span>
<span class="line"><span style="color:#F07178;">  	</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">Time</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">time</span><span style="color:#89DDFF;">={</span><span style="color:#A6ACCD;">time</span><span style="color:#89DDFF;">} /&gt;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">PureAllPrimes</span><span style="color:#89DDFF;"> /&gt;</span></span>
<span class="line"><span style="color:#F07178;">  )</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><p>React.memo å¯ä»¥æŠŠä¸€ä¸ªç»„ä»¶å˜æˆ pure componentï¼Œpure component åªæœ‰åœ¨ props å˜åŒ–çš„æ—¶å€™ï¼Œæ‰ä¼š re-renderï¼›</p><p>å½“ç„¶ï¼Œä¹Ÿå¯ä»¥åœ¨ AllPrimes ç»„ä»¶é‡Œï¼Œå¯¼å‡ºçš„æ—¶å€™å»ä½¿ç”¨ React.memo</p><div class="language-tsx"><button title="Copy Code" class="copy"></button><span class="lang">tsx</span><pre class="shiki"><code><span class="line"><span style="color:#89DDFF;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">default</span><span style="color:#A6ACCD;"> React</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">memo</span><span style="color:#A6ACCD;">(AllPrimes)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><p>æˆ‘ä»¬æ¥ä¸¾å¦å¤–ä¸€ä¸ªä¾‹å­</p><p>Boxes æ˜¯ä¸€ä¸ª pure component,åªæœ‰ boxes å˜åŒ–çš„æ—¶å€™ï¼Œæ‰ä¼š re-render;</p><div class="language-tsx"><button title="Copy Code" class="copy"></button><span class="lang">tsx</span><pre class="shiki"><code><span class="line"><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Boxes</span><span style="color:#89DDFF;">({</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">boxes</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">})</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">return</span><span style="color:#F07178;"> (</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">div</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">className</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">boxes-wrapper</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;">boxes</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">map</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">boxStyles</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">index</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> (</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">div</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">key</span><span style="color:#89DDFF;">={</span><span style="color:#A6ACCD;">index</span><span style="color:#89DDFF;">} </span><span style="color:#C792EA;">className</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">box</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">style</span><span style="color:#89DDFF;">={</span><span style="color:#A6ACCD;">boxStyles</span><span style="color:#89DDFF;">} /&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">      ))</span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">div</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#F07178;">  )</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">default</span><span style="color:#A6ACCD;"> React</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">memo</span><span style="color:#A6ACCD;">(Boxes)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><p>App ç»„ä»¶é‡Œå¼•ç”¨äº† Boxes,å¹¶å£°æ˜å¸¸é‡ boxes ä¼ å…¥ Boxes ç»„ä»¶é‡Œ</p><div class="language-tsx"><button title="Copy Code" class="copy"></button><span class="lang">tsx</span><pre class="shiki"><code><span class="line"><span style="color:#89DDFF;">import</span><span style="color:#A6ACCD;"> Boxes </span><span style="color:#89DDFF;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./Boxes</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">App</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">name</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">setName</span><span style="color:#89DDFF;">]</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">React</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">useState</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;&#39;</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">boxWidth</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">setBoxWidth</span><span style="color:#89DDFF;">]</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">React</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">useState</span><span style="color:#F07178;">(</span><span style="color:#F78C6C;">1</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">boxes</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> [</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> flex</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">boxWidth</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> background</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">hsl(345deg 100% 50%)</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> flex</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">3</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> background</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">hsl(260deg 100% 40%)</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> flex</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> background</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">hsl(50deg 100% 60%)</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#F07178;">  ]</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">return</span><span style="color:#F07178;"> (</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">&lt;&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">Boxes</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">boxes</span><span style="color:#89DDFF;">={</span><span style="color:#A6ACCD;">boxes</span><span style="color:#89DDFF;">} /&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">      &lt;-çœç•¥dom-&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;/&gt;</span></span>
<span class="line"><span style="color:#F07178;">  )</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><p>å½“çŠ¶æ€ name å˜åŒ–çš„æ—¶å€™ï¼Œæˆ‘ä»¬æœŸæœ›åªæ˜¯ re-render App ç»„ä»¶ï¼ŒBoxes ç»„ä»¶ä¸ re-renderï¼Œç„¶è€Œ Boxes ç»„ä»¶ä»ç„¶ re-render äº†ã€‚è¿™æ˜¯å› ä¸ºï¼ŒApp ç»„ä»¶ re-render çš„æ—¶å€™ï¼Œé‡æ–°ç”Ÿæˆäº† boxes å˜é‡ï¼Œå°½ç®¡æ˜¯åŒæ ·çš„å€¼ï¼Œä½†ä¸æ˜¯ä¸€ä¸ªå¼•ç”¨ï¼Œæ‰€ä»¥å¯¼è‡´äº† Boxes ç»„ä»¶çš„ re-render</p><p>è¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œåªéœ€è¦ä½¿ç”¨ useMemo åŒ…è£¹ä¸€ä¸‹å³å¯</p><div class="language-tsx"><button title="Copy Code" class="copy"></button><span class="lang">tsx</span><pre class="shiki"><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> boxes </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> React</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">useMemo</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">return</span><span style="color:#F07178;"> [</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> flex</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">boxWidth</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> background</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">hsl(345deg 100% 50%)</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> flex</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">3</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> background</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">hsl(260deg 100% 40%)</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> flex</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> background</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">hsl(50deg 100% 60%)</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#F07178;">  ]</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">},</span><span style="color:#A6ACCD;"> [boxWidth])</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><h3 id="usecallback" tabindex="-1">UseCallback <a class="header-anchor" href="#usecallback" aria-hidden="true">#</a></h3><p>å®ƒè·Ÿ useMemo æ˜¯ä¸€æ ·çš„ï¼Œéƒ½æ˜¯ç¼“å­˜å‡½æ•°ï¼Œä½†æ˜¯ä»–ç¼“å­˜çš„ä¸æ˜¯å€¼ï¼Œè€Œæ˜¯å‡½æ•°ï¼›</p><h4 id="ä½¿ç”¨åœºæ™¯ä¸¾ä¾‹" tabindex="-1">ä½¿ç”¨åœºæ™¯ä¸¾ä¾‹ <a class="header-anchor" href="#ä½¿ç”¨åœºæ™¯ä¸¾ä¾‹" aria-hidden="true">#</a></h4><p>MegaBoost æ˜¯ä¸€ä¸ª pure component,æ¥å—ä¸€ä¸ª callback å›è°ƒå‡½æ•°ï¼Œåªæœ‰å½“ callback å˜åŒ–çš„æ—¶å€™æ‰ä¼š re-render</p><div class="language-tsx"><button title="Copy Code" class="copy"></button><span class="lang">tsx</span><pre class="shiki"><code><span class="line"><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">MegaBoost</span><span style="color:#89DDFF;">({</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">handleClick</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">})</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Render MegaBoost</span><span style="color:#89DDFF;">&quot;</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">return</span><span style="color:#F07178;"> (</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">button</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">className</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">mega-boost-button</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">onClick</span><span style="color:#89DDFF;">={</span><span style="color:#A6ACCD;">handleClick</span><span style="color:#89DDFF;">}&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">      MEGA BOOST!</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">button</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#F07178;">  )</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">default</span><span style="color:#A6ACCD;"> React</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">memo</span><span style="color:#A6ACCD;">(MegaBoost)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><p>App ç»„ä»¶é‡Œå¼•ç”¨äº† MegaBoost</p><div class="language-tsx"><button title="Copy Code" class="copy"></button><span class="lang">tsx</span><pre class="shiki"><code><span class="line"><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">App</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">count</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">setCount</span><span style="color:#89DDFF;">]</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">React</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">useState</span><span style="color:#F07178;">(</span><span style="color:#F78C6C;">0</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">function</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">handleMegaBoost</span><span style="color:#89DDFF;">()</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#82AAFF;">setCount</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">currentValue</span><span style="color:#89DDFF;">)</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">currentValue</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">+</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">1234</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">return</span><span style="color:#F07178;"> (</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">&lt;&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">      Count: </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;">count</span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">button</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#C792EA;">onClick</span><span style="color:#89DDFF;">={()</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">          </span><span style="color:#82AAFF;">setCount</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">count</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">+</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">1</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;">}}</span></span>
<span class="line"><span style="color:#89DDFF;">      &gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">        Click me!</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">button</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">MegaBoost</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">handleClick</span><span style="color:#89DDFF;">={</span><span style="color:#A6ACCD;">handleMegaBoost</span><span style="color:#89DDFF;">} /&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;/&gt;</span></span>
<span class="line"><span style="color:#F07178;">  )</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">default</span><span style="color:#A6ACCD;"> App</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><p>App é‡Œå£°æ˜äº†ä¸€ä¸ªçŠ¶æ€ countï¼Œä¸€ä¸ªå‡½æ•° handleMegaBoost å¹¶ä¼ å…¥ MegaBoost ç»„ä»¶ã€‚</p><p>å½“çŠ¶æ€ count å˜åŒ–çš„æ—¶å€™ï¼Œä¼šè§¦å‘ App ç»„ä»¶çš„ re-renderï¼Œå¹¶ä¸”é‡æ–°ç”Ÿæˆä¸€ä¸ªæ–°çš„ handleMegaBoost ä¼ å…¥ MegaBoost ç»„ä»¶ï¼Œå¯¼è‡´ MegaBoost ç»„ä»¶çš„ re-renderã€‚</p><p>æ€ä¹ˆè§£å†³è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿå¾ˆç®€å•ï¼Œä½¿ç”¨ç¼“å­˜å‡½æ•°å³å¯</p><div class="language-tsx"><button title="Copy Code" class="copy"></button><span class="lang">tsx</span><pre class="shiki"><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> handleMegaBoost </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> React</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">useMemo</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">return</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">function</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">()</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#82AAFF;">setCount</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">currentValue</span><span style="color:#89DDFF;">)</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">currentValue</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">+</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">1234</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">};</span></span>
<span class="line"><span style="color:#89DDFF;">},</span><span style="color:#A6ACCD;"> [])</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><p>ä½†æ˜¯ï¼Œä¸€èˆ¬æˆ‘ä»¬æ›´å€¾å‘äºä½¿ç”¨ useCallback</p><div class="language-tsx"><button title="Copy Code" class="copy"></button><span class="lang">tsx</span><pre class="shiki"><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> handleMegaBoost </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> React</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">useCallback</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#82AAFF;">setCount</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">currentValue</span><span style="color:#89DDFF;">)</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">currentValue</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">+</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">1234</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">},</span><span style="color:#A6ACCD;"> [])</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><h3 id="æ€»ç»“" tabindex="-1">æ€»ç»“ <a class="header-anchor" href="#æ€»ç»“" aria-hidden="true">#</a></h3><ol><li>ç»„ä»¶é‡Œä¸€äº›â€ç»è¿‡å¤æ‚çš„é€»è¾‘è®¡ç®—è€Œå¾—åˆ°æŸä¸ªå€¼â€œéœ€è¦ä½¿ç”¨ Usememo åŒ…è£¹ï¼Œä¿è¯ç»„ä»¶åœ¨ re-render çš„æ—¶å€™ä¸å»é‡å¤è®¡ç®—</li><li>çˆ¶å­ç»„ä»¶çš„åœºæ™¯ï¼Œå­ç»„ä»¶å°½é‡ç”¨ React.memo åŒ…è£¹æˆ pure componentï¼Œé¿å…çˆ¶ç»„ä»¶çš„ re-render å¯¼è‡´å­ç»„ä»¶è·Ÿç€ä¸€èµ· re-render</li><li>çˆ¶å­ç»„ä»¶çš„åœºæ™¯ï¼Œçˆ¶ç»„ä»¶å£°æ˜å˜é‡ä¼ å…¥å­ç»„ä»¶çš„æ—¶å€™ï¼Œå°½é‡ç”¨ useMemo åŒ…è£¹ï¼Œé¿å…çˆ¶ç»„ä»¶ re-render å¯¼è‡´é‡æ–°ç”Ÿæˆå˜é‡ï¼Œè€Œè¿›ä¸€æ­¥å¯¼è‡´å­ç»„ä»¶çš„ re-render</li><li>çˆ¶å­ç»„ä»¶çš„åœºæ™¯ï¼Œå‰¯ç»„ä»¶å£°æ˜ callback ä¼ å…¥å­ç»„ä»¶çš„æ—¶å€™ï¼Œå°½é‡ä½¿ç”¨ useCallback åŒ…è£¹ï¼Œé¿å…çˆ¶ç»„ä»¶ re-render å¯¼è‡´é‡æ–°ç”Ÿæˆ callbackï¼Œè€Œè¿›ä¸€æ­¥å¯¼è‡´å­ç»„ä»¶çš„ re-render</li></ol><h3 id="å¼•ç”¨é“¾æ¥" tabindex="-1">å¼•ç”¨é“¾æ¥ <a class="header-anchor" href="#å¼•ç”¨é“¾æ¥" aria-hidden="true">#</a></h3><p><a href="https://www.joshwcomeau.com/react/usememo-and-usecallback/#use-case-2-preserved-references" target="_blank" rel="noreferrer">å¼•ç”¨é“¾æ¥</a></p></div></div></main><!--[--><!--]--><!----><!--[--><!--]--></div></div></div></div></div><!----><!--[--><!--]--></div><footer data-v-3aca7521> Powered by <a href="https://github.com/helloklein" target="_blank" title="ä½œè€…" data-v-3aca7521>klein</a> | Copyright Â© 2019-2024 | MIT License </footer><!--]--></div>
    <script>__VP_HASH_MAP__ = JSON.parse("{\"readme.md\":\"7ad9c6d9\",\"archives.md\":\"81b0d41f\",\"posts_proxyconfig.md\":\"66ad70b3\",\"tags.md\":\"48885557\",\"posts_macå¤–æ¥æ˜¾ç¤ºå™¨.md\":\"f43e7646\",\"posts_cosmosè¯¦è§£.md\":\"a5465a07\",\"posts_vue3çš„eventbusåº“(mitt)ä¸mittçš„ä½¿ç”¨æ–¹å¼.md\":\"85b409e3\",\"index.md\":\"87b3859a\",\"posts_vue3æ­å»ºé¡¹ç›®.md\":\"c6675758\",\"posts_pm2çš„ä»‹ç»å’Œä½¿ç”¨.md\":\"161f6530\",\"posts_tsä¸­typeå’Œinterfaceçš„åŒºåˆ«.md\":\"de110e47\",\"posts_vueå®ç°éªŒè¯ç çš„60så€’è®¡æ—¶.md\":\"5dc8b00a\",\"posts_nuxtå‘å¸ƒéƒ¨ç½².md\":\"1757f373\",\"posts_åŒºå—é“¾ç§‘æ™®.md\":\"0caefdb6\",\"posts_cssæ§åˆ¶å•è¡Œæˆ–è€…å¤šè¡Œæ–‡æœ¬è¶…å‡ºæ˜¾ç¤ºçœç•¥å·.md\":\"9178dd48\",\"posts_vueå›½é™…åŒ–.md\":\"0982f16c\",\"posts_å˜é‡æå‡.md\":\"e789a7c6\",\"posts_reactä¼˜åŒ–.md\":\"0fab6639\",\"posts_webå‰ç«¯é¢è¯•é¢˜.md\":\"5bc421bf\",\"posts_new date() è·å–æ—¶é—´.md\":\"94c444c6\",\"posts_ç§»åŠ¨ç«¯è‡ªé€‚åº”.md\":\"29b383ef\",\"posts_js å­—ç¬¦ä¸²æˆªå–æ–¹æ³•.md\":\"bf23d57a\",\"posts_vueä¸­çš„åŠ¨æ€ç±»åä»¥åŠåŠ¨æ€æ ·å¼.md\":\"e8f58f63\",\"posts_å…¨å±€æ ·å¼css.md\":\"1ccb4a8a\",\"posts_è™šæ‹Ÿæœºé…ç½®.md\":\"806ef7d4\",\"posts_vueä¸­å¦‚ä½•è·å–å½“å‰è·¯ç”±åœ°å€.md\":\"d8029261\",\"posts_vueæ ¸å¿ƒåŸç†ä¹‹ ast æŠ½è±¡è¯­æ³•æ ‘ç†è§£åŠç®—æ³•.md\":\"bbb9485d\",\"posts_csså›¾ç‰‡é¢„åŠ è½½çš„å‡ ç§æ–¹å¼.md\":\"baaa0ff1\",\"posts_pythonåŸºç¡€.md\":\"4a2a137a\",\"posts_vue3ä¸­tsxå’Œhå‡½æ•°çš„ç”¨æ³•.md\":\"2b7584f1\",\"posts_typescriptå­¦ä¹ ç¬”è®°.md\":\"0320d66c\",\"posts_æ™ºèƒ½åˆçº¦å¼€å‘.md\":\"ebfc2e12\",\"posts_ä»£ç é£æ ¼çº¦æŸ.md\":\"362ef5ed\"}")</script>
    <script type="module" async src="/klein/assets/app.4feed8ca.js"></script>
    
  </body>
</html>